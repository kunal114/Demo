import os
import shutil
from pathlib import Path

def pick_and_copy_file():
    # Get the path to the Downloads folder
    downloads_path = str(Path.home() / "Downloads")
    
    # Get the current directory
    current_dir = os.getcwd()
    
    # List all files in the Downloads folder
    files = os.listdir(downloads_path)
    
    # Display the list of files
    print("Files in Downloads folder:")
    for i, file in enumerate(files):
        print(f"{i + 1}. {file}")
    
    # Ask the user to choose a file
    while True:
        try:
            choice = int(input("Enter the number of the file you want to copy: ")) - 1
            if 0 <= choice < len(files):
                selected_file = files[choice]
                break
            else:
                print("Invalid choice. Please try again.")
        except ValueError:
            print("Please enter a valid number.")
    
    # Construct the full path of the selected file
    source_path = os.path.join(downloads_path, selected_file)
    
    # Construct the destination path in the current directory
    dest_path = os.path.join(current_dir, selected_file)
    
    # Copy the file
    shutil.copy2(source_path, dest_path)
    
    print(f"File '{selected_file}' has been copied to the current directory.")

if __name__ == "__main__":
    pick_and_copy_file()
