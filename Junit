import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.Import;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import static org.junit.jupiter.api.Assertions.*;

@ExtendWith(SpringExtension.class)
@SpringBootTest
@Import(SecurityConfiguration.class)
@ActiveProfiles("taws")
public class SecurityConfigurationTest {

    @Autowired
    private SecurityConfiguration securityConfiguration;

    @Test
    public void testFilterChain() throws Exception {
        HttpSecurity http = new HttpSecurity(null, null, null);
        SecurityFilterChain filterChain = securityConfiguration.filterChain(http);

        assertNotNull(filterChain);

        // Test that all requests are permitted
        assertTrue(http.getAuthorizeHttpRequests().getMatchers().contains(AnyRequestMatcher.INSTANCE));

        // Test that CSRF is disabled
        assertFalse(http.getConfigurer(CsrfConfigurer.class).isEnabled());
    }
}
