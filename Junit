index=* sourcetype=*access* api_endpoint="*"
| eval response_time=round(response_time,2)
| stats 
    count as total_requests
    avg(response_time) as avg_response_time
    count(eval(status>=500)) as server_errors
    count(eval(status>=400 AND status<500)) as client_errors
    count(eval(status>=200 AND status<300)) as success
    by status api_endpoint
| sort -total_requests
